You are working on TAW Theme — a classic WordPress theme with a custom block architecture.

Full architecture docs: see AGENTS.md in the repo root.

## Core Package

Framework internals live in the `taw/core` composer package at `vendor/taw/core/src/` — NOT in `inc/`.
- `TAW\Core\*` → `vendor/taw/core/src/Core/`
- `TAW\Helpers\*` → `vendor/taw/core/src/Helpers/`
- `TAW\CLI\*` → `vendor/taw/core/src/CLI/`
- `vite-loader.php` and `performance.php` → `vendor/taw/core/src/Support/` (autoloaded by composer)
- The theme's `inc/` only has `options.php` and Metabox view templates

Do NOT edit anything inside `vendor/taw/core/`. To update the framework: `composer update taw/core`.

Key rules:
- Blocks live in Blocks/{Name}/{Name}.php — folder MUST match class name
- MetaBlock = data-owning (metaboxes + post_meta), Block = presentational (props)
- Auto-discovery via BlockLoader::loadAll() — never register manually in functions.php
- Template pattern: BlockRegistry::queue() before get_header(), render() in body
- PSR-4 (theme): TAW\Blocks\ → Blocks/ only — all other TAW\ classes come from taw/core
- Stack: WordPress, Tailwind v4, Alpine.js v3, Vite v7, SCSS, bespoke Metabox framework
- Always escape output: esc_html(), esc_url(), esc_attr()
- Meta key pattern: _taw_{field_id}; option key pattern: _taw_{field_id}

New blocks:
- Scaffold with: php bin/taw make:block Name --type=meta --with-style && composer dump-autoload
- Or manually create Blocks/{Name}/{Name}.php + index.php (no functions.php changes)

Options page:
- OptionsPage (from taw/core) stores site settings in wp_options, same field config as Metabox
- Configured in inc/options.php; retrieve with OptionsPage::get('field_id')

Navigation menus:
- Use TAW\Core\Menu\Menu::get('location') instead of wp_nav_menu()
- Returns typed Menu / MenuItem tree with active-state and children support

Image helper:
- TAW\Helpers\Image::render($id, 'size', 'alt', ['above_fold' => true])
- Generates performance-optimised <img> with correct loading/fetchpriority/srcset

REST API:
- GET taw/v1/search-posts — powers the post_selector metabox field type

Metabox field types: text, textarea, wysiwyg, url, number, select, image, group, checkbox, color, repeater, post_selector
